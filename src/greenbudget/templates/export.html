{% load export_tags %}
<html>
    <head>
        <title>{{budget.name}}</title>
        <style type="text/css">
            @font-face {
              font-family: 'Nunito-Light';
              src: local('Nunito-Light'), url('/static/fonts/Nunito-Light.ttf') format("truetype");
              font-style: normal;
              font-weight: normal;
            }
            @font-face {
              font-family: 'Nunito-Regular';
              src: local('Nunito-Regular'), url('/static/fonts/Nunito-Regular.ttf') format("truetype");
              font-style: normal;
              font-weight: normal;
            }
            @font-face {
              font-family: 'Nunito-SemiBold';
              src: local('Nunito-SemiBold'), url('/static/fonts/Nunito-SemiBold.ttf') format("truetype");
              font-style: normal;
              font-weight: normal;
            }
            @font-face {
              font-family: 'Nunito-Bold';
              src: local('Nunito-Bold'), url('/static/fonts/Nunito-Bold.ttf') format("truetype");
              font-style: bold;
              font-weight: bold;
            }
            .budget-title {
                font-size: 32px;
                font-family: 'Nunito-SemiBold';
                color: #404151;
                text-transform: capitalize;
                margin-bottom: 0px;
            }
            .budget-subtitle {
                margin-top: 0px;
                color: #404151;
            }
            table {
              border: 1px solid #f7f7f7;
              font-family: 'Nunito-Regular';
            }
            table tbody tr {
              padding: 4px;
            }
            table tbody tr td.highlighted {
              background-color: #f7f7f7;
            }
            table tbody tr td.bold {
              font-family: 'Nunito-SemiBold';
            }
            table tbody tr td.medium {
              font-weight: 500;
            }
            table tbody tr td.regular {
              font-family: 'Nunito-Regular';
            }
            table tbody tr td.light {
              font-family: 'Nunito-Light';
            }
            .accounts-table {
              margin-bottom: 25px;
            }
            .accounts-table thead tr {
              background-color: #F7F7F7;
              font-family: 'Nunito-SemiBold';
              color: #404151;
              padding: 4px;
            }
            .accounts-table tbody tr > .identifier {
              width: 10%;
            }
            .accounts-table tbody tr > .description {
              width: 70%;
            }
            .accounts-table tbody tr > .estimated {
              width: 20%;
            }
            .account-table {
              margin-bottom: 25px;
            }
            .account-table thead tr {
              background-color: #F7F7F7;
              font-family: 'Nunito-SemiBold';
              color: #404151;
              padding: 4px;
            }
            .account-table tbody tr.account > td.identifier {
              font-family: 'Nunito-SemiBold';
              width: 10%;
            }
            .account-table tbody tr.account > td.description {
              font-family: 'Nunito-SemiBold';
            }
            .account-table tbody tr.subaccount > td.identifier {
              font-family: 'Nunito-Regular';
              width: 10%;
              color: #b5b5b5;
            }
            .account-table tbody tr.subaccount > td.description {
              font-family: 'Nunito-SemiBold';
              width: 30%;
            }
            .account-table tbody tr.subaccount > td.name {
              font-family: 'Nunito-Light';
              width: 10%;
            }
            .account-table tbody tr.subaccount > td.quantity {
              font-family: 'Nunito-Regular';
              width: 8%;
            }
            .account-table tbody tr.subaccount > td.unit {
              font-family: 'Nunito-Regular';
              width: 12%;
            }
            .account-table tbody tr.subaccount > td.multiplier {
              font-family: 'Nunito-Regular';
              width: 8%;
            }
            .account-table tbody tr.subaccount > td.rate {
              font-family: 'Nunito-Regular';
              width: 10%;
            }
            .account-table tbody tr.subaccount > td.total {
              font-family: 'Nunito-SemiBold';
              width: 12%;
            }
            .account-table tbody tr.subaccount-with-children > td.identifier {
              font-family: 'Nunito-Regular';
              width: 10%;
              color: #b5b5b5;
            }
            .account-table tbody tr.subaccount-with-children > td.description {
              font-weight: 500;
            }
            .account-table tbody tr.detail {
              border-bottom: none !important;
              border-top: none !important;
            }
            .account-table tbody tr.detail > td {
              border-right: none !important;
              border-left: none !important;
            }
            .account-table tbody tr.detail > .identifier {
              width: 10%;
            }
            .account-table tbody tr.detail > .description {
              padding-left: 20px;
              font-family: 'Nunito-Light';
              width: 30%;
            }
            .account-table tbody tr.detail > td.name {
              font-family: 'Nunito-Light';
              width: 10%;
            }
            .account-table tbody tr.detail > td.quantity {
              font-family: 'Nunito-Light';
              width: 8%;
            }
            .account-table tbody tr.detail > td.unit {
              font-family: 'Nunito-Light';
              width: 12%;
            }
            .account-table tbody tr.detail > td.multiplier {
              font-family: 'Nunito-Light';
              width: 8%;
            }
            .account-table tbody tr.detail > td.rate {
              font-family: 'Nunito-Light';
              width: 10%;
            }
            .account-table tbody tr.detail > td.total {
              font-family: 'Nunito-SemiBold';
              width: 12%;
            }

            .border-both {
              border-left: 1px solid #f7f7f7;
              border-right: 1px solid #f7f7f7;
            }
            .border-right {
              border-right: 1px solid #f7f7f7;
            }
        </style>
    </head>
    <body>
        <div>
          <h1 class="budget-title">{{budget.name}}</h1>
          <h4 class="budget-subtitle">Cost Summary</h4>
        </div>

        <table class="accounts-table">
          <thead>
            <tr>
              <td scope="col"><span>Acct #</span></td>
              <td scope="col">Category Description</td>
              <td scope="col">Estimated</td>
            </tr>
          </thead>
          <tbody>
            {% for account in budget.accounts.all %}
              <tr>
                <td class="border-both identifier">{{account.identifier}}</td>
                {% if account.description != None %}
                  <td class="description">{{account.description}}</td>
                {% else %}
                  <td class="description"></td>
                {% endif %}
                {% if account.estimated != None %}
                <td class="border-both estimated">{{account.estimated|format_as_dollar}}</td>
                {% else %}
                <td class="border-both estimated">{{0.00|format_as_dollar}}</td>
                {% endif %}
              </tr>
            {% endfor %}
            <tr>
              <td class="border-both identifier">Total</td>
              <td class="description"></td>
              {% if budget.estimated != None %}
              <td class="border-both estimated">{{budget.estimated|format_as_dollar}}</td>
              {% else %}
              <td class="border-both estimated">{{0.00|format_as_dollar}}</td>
              {% endif %}
            </tr>
          </tbody>
        </table>

        {% for account in budget.accounts.all %}
          <table class="account-table">
            <thead>
              <tr>
                <td scope="col">Acct</td>
                <td scope="col">Description</td>
                <td scope="col">Name</td>
                <td scope="col">Qty</td>
                <td scope="col">Unit</td>
                <td scope="col">X</td>
                <td scope="col">Rate</td>
                <td scope="col">Total</td>
              </tr>
            </thead>
            <tbody>
              <tr class="account">
                <td class="border-both identifier">{{account.identifier}}</td>
                <td class="description highlighted" colspan=7>{{account.description}}</td>
              </tr>
              {% for subaccount in account.subaccounts.all %}
                {% if subaccount.subaccounts.all.length == 0 %}
                  <tr class="subaccount">
                    <td class="border-both identifier">{{subaccount.identifier}}</td>
                    {% if subaccount.description != None %}
                      <td class="description">{{subaccount.description}}</td>
                    {% else %}
                      <td class="description"></td>
                    {% endif %}
                    {% if subaccount.name != None %}
                      <td class="name">{{subaccount.name}}</td>
                    {% else %}
                      <td class="name"></td>
                    {% endif %}
                    {% if subaccount.quantity != None %}
                      <td class="quantity">{{subaccount.quantity}}</td>
                    {% else %}
                      <td class="quantity"></td>
                    {% endif %}
                    {% if subaccount.unit != None %}
                      <td class="unit">{{subaccount.unit}}</td>
                    {% else %}
                      <td class="unit"></td>
                    {% endif %}
                    {% if subaccount.multiplier != None %}
                      <td class="multiplier">{{subaccount.multiplier}}</td>
                    {% else %}
                      <td class="multiplier"></td>
                    {% endif %}
                    {% if subaccount.rate != None %}
                      <td class="rate">{{subaccount.rate}}</td>
                    {% else %}
                      <td class="rate"></td>
                    {% endif %}
                    <td class="rate">{{subaccount.rate}}</td>
                    {% if subaccount.estimated != None %}
                      <td class="estimated">{{subaccount.estimated|format_as_dollar}}</td>
                    {% else %}
                      <td class="estimated">{{0.00|format_as_dollar}}</td>
                    {% endif %}
                  </tr>
                {% else %}
                  <tr class="subaccount-with-children">
                    <td class="border-both identifier">{{subaccount.identifier}}</td>
                    {% if subaccount.description != None %}
                      <td class="description" colspan=7>{{subaccount.description}}</td>
                    {% else %}
                      <td class="description" colspan=7></td>
                    {% endif %}
                  </tr>
                  {% for detail in subaccount.subaccounts.all %}
                    <tr class="detail">
                      <td class="border-both identifier"></td>
                      {% if detail.description != None %}
                        <td class="description">{{detail.description}}</td>
                      {% else %}
                        <td class="description"></td>
                      {% endif %}
                      {% if detail.name != None %}
                        <td class="name">{{detail.name}}</td>
                      {% else %}
                        <td class="name"></td>
                      {% endif %}
                      {% if detail.quantity != None %}
                        <td class="quantity">{{detail.quantity}}</td>
                      {% else %}
                        <td class="quantity"></td>
                      {% endif %}
                      {% if detail.unit != None %}
                        <td class="unit">{{detail.unit}}</td>
                      {% else %}
                        <td class="unit"></td>
                      {% endif %}
                      {% if detail.multiplier != None %}
                        <td class="multiplier">{{detail.multiplier}}</td>
                      {% else %}
                        <td class="multiplier"></td>
                      {% endif %}
                      {% if detail.rate != None %}
                        <td class="rate">{{detail.rate}}</td>
                      {% else %}
                        <td class="rate"></td>
                      {% endif %}
                      {% if detail.estimated != None %}
                        <td class="estimated border-right">{{detail.estimated|format_as_dollar}}</td>
                      {% else %}
                        <td class="estimated border-right">{{0.00|format_as_dollar}}</td>
                      {% endif %}
                    </tr>
                  {% endfor %}
                {% endif %}
              {% endfor %}
            </tbody>
          </table>
        {% endfor %}
    </body>
</html>
